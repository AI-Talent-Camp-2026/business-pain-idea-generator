"""
Russian language prompts for idea generation
"""
import random

# Список различных направлений для случайной генерации
BUSINESS_DIRECTIONS = [
    "B2B SaaS для стартапов и фаундеров",
    "автоматизация процессов для малого бизнеса",
    "образовательные технологии и онлайн-обучение",
    "инструменты для удаленной работы и коммуникации",
    "маркетинг и продажи для e-commerce",
    "финансовые инструменты и учет для малого бизнеса",
    "HR-tech и управление персоналом",
    "логистика и доставка",
    "сервисы для фрилансеров и креаторов",
    "аналитика и визуализация данных",
    "кибербезопасность для малого бизнеса",
    "медицинские технологии и телемедицина",
    "инструменты для продуктивности и тайм-менеджмента",
    "платформы для создания контента",
    "решения для недвижимости и PropTech",
    "экологические технологии и устойчивое развитие",
    "сервисы для разработчиков и DevOps",
    "управление проектами и командной работой",
    "персонализация и рекомендательные системы",
    "инструменты для event-менеджмента",
    # Дополнительные 50 направлений
    "LegalTech и автоматизация юридических процессов",
    "инструменты для customer success и retention",
    "платформы для B2B-маркетплейсов",
    "решения для управления инвентарем и складом",
    "сервисы для автоматизации рекрутинга",
    "платформы для peer-to-peer обучения",
    "инструменты для email-маркетинга и автоматизации",
    "решения для управления подпиской и SaaS-биллингом",
    "API-платформы и интеграционные решения",
    "инструменты для A/B тестирования и оптимизации конверсий",
    "платформы для создания лендингов и сайтов без кода",
    "сервисы для управления репутацией и отзывами",
    "инструменты для SEO и контент-маркетинга",
    "решения для видеоконференций и вебинаров",
    "платформы для краудфандинга и сбора инвестиций",
    "сервисы для управления социальными сетями",
    "инструменты для автоматизации бухгалтерии",
    "платформы для создания мобильных приложений без кода",
    "решения для управления клиентской базой (CRM)",
    "сервисы для автоматизации продаж и lead generation",
    "инструменты для внутренних коммуникаций компании",
    "платформы для организации корпоративного обучения",
    "решения для мониторинга и аналитики приложений",
    "сервисы для управления договорами и документами",
    "инструменты для создания чат-ботов и AI-ассистентов",
    "платформы для организации хакатонов и конкурсов",
    "решения для управления облачной инфраструктурой",
    "сервисы для автоматизации тестирования ПО",
    "инструменты для управления API и документацией",
    "платформы для создания онлайн-курсов и вебинаров",
    "решения для управления техподдержкой и тикетами",
    "сервисы для автоматизации invoice и платежей",
    "инструменты для управления знаниями и wiki",
    "платформы для B2B lead enrichment и верификации данных",
    "решения для управления поставщиками и закупками",
    "сервисы для автоматизации email-подписей и брендинга",
    "инструменты для создания продуктовой аналитики",
    "платформы для организации менторства и коучинга",
    "решения для управления комплаенсом и регуляторикой",
    "сервисы для создания внутренних инструментов компании",
    "инструменты для управления feedback и опросами",
    "платформы для создания партнерских программ",
    "решения для автоматизации onboarding сотрудников",
    "сервисы для управления корпоративными расходами",
    "инструменты для создания документации и API-справочников",
    "платформы для организации менторских сессий",
    "решения для автоматизации compliance и аудита",
    "сервисы для управления контрактами с фрилансерами",
    "инструменты для создания дашбордов и отчетности",
    "платформы для организации pitch-сессий для стартапов",
    "решения для управления SLA и service desk",
    "сервисы для автоматизации PR и media relations",
    "инструменты для управления технологическим стеком компании",
    "платформы для создания community и форумов",
    "решения для управления удаленными командами",
    "сервисы для автоматизации контент-календарей",
    "инструменты для управления партнерскими отношениями",
    "платформы для организации networking-мероприятий",
    "решения для автоматизации customer onboarding",
    "сервисы для управления версиями и релизами продуктов",
    "инструменты для создания интерактивных демо и туров",
    "платформы для организации peer review кода",
    "решения для управления feature flags и A/B экспериментами",
    "сервисы для автоматизации changelog и release notes",
    "инструменты для управления технической документацией",
    "платформы для создания product roadmap и планирования",
    "решения для управления incident response и мониторинга",
    "сервисы для автоматизации sales enablement",
    "инструменты для создания интерактивных презентаций"
]

SYSTEM_PROMPT = """Ты - эксперт по анализу пользовательских болей и генерации бизнес-идей.
Все твои ответы должны быть на русском языке.
Ты работаешь для русскоязычных фаундеров и продакт-менеджеров."""


GENERATE_IDEAS_PROMPT = """На основе направления "{direction}", сгенерируй 12-15 бизнес-идей.

Для каждой идеи выдай в формате JSON:
{{
  "ideas": [
    {{
      "title": "Название идеи (макс 100 символов)",
      "pain_description": "Описание боли (1-2 абзаца, 100-300 слов)",
      "segment": "Кому болит (целевая аудитория)",
      "confidence_level": "high|medium|low",
      "brief_evidence": "Краткие доказательства боли (2-5 строк паттернов поведения)",
      "analogues": [
        {{
          "name": "Название аналога",
          "description": "Что делают (1-2 предложения)",
          "url": "https://example.com"
        }},
        ...
      ],
      "plan_7days": "План реализации на 7 дней для one-person company (5-7 шагов)",
      "plan_30days": "План реализации на 30 дней (10-15 шагов с неделями)"
    }}
  ]
}}

Требования:
- Все тексты на русском языке
- Каждая идея должна иметь минимум 2 аналога
- Боли должны быть конкретными и проверяемыми
- Планы должны быть реалистичными для небольшой команды/соло-фаундера
- Используй реальные примеры аналогов с настоящими URL
- Confidence level зависит от силы доказательств боли

Отвечай только валидным JSON без дополнительных комментариев."""


QUICK_IDEAS_PROMPT = """Сгенерируй 10 бизнес-идей для направления: {direction}

Каждая идея должна содержать:
1. Название (краткое, на русском)
2. Описание боли (кому и что мешает)
3. Целевая аудитория
4. 2-3 существующих решения (аналоги) с URL
5. План на 7 дней и 30 дней
6. Уровень уверенности (высокий/средний/низкий)

Формат ответа: JSON массив объектов с полями: title, pain_description, segment, confidence_level, brief_evidence, analogues (массив с name, description, url), plan_7days, plan_30days.

Только JSON, без дополнительного текста."""


GENERATE_IDEAS_FROM_REAL_PAINS_PROMPT = """На основе РЕАЛЬНЫХ пользовательских болей, найденных в интернете, сгенерируй 10-15 бизнес-идей.

Направление: {direction}

РЕАЛЬНЫЕ БОЛИ ПОЛЬЗОВАТЕЛЕЙ (найдены через Tavily Search в Reddit, Indie Hackers, форумах):
{real_pains}

ВАЖНО: Для каждой боли предложи 2-3 РАЗНЫХ подхода к решению (разные бизнес-модели, разные MVP, разные целевые сегменты).
Это даст пользователю больше вариантов для выбора.

Для каждой идеи создай запись в формате JSON:
{{
  "ideas": [
    {{
      "title": "Название идеи (макс 100 символов)",
      "pain_description": "Описание боли из реальных данных (используй evidence_quotes)",
      "segment": "Кому болит (из реальных данных)",
      "confidence_level": "high|medium|low (из реальных данных)",
      "brief_evidence": "Доказательства из реальных обсуждений (цитаты)",
      "analogues": [
        {{
          "name": "Название существующего решения",
          "description": "Что делают (1-2 предложения)",
          "url": "https://example.com"
        }}
      ],
      "plan_7days": "План MVP на 7 дней для solo-founder (5-7 шагов)",
      "plan_30days": "План развития на 30 дней (10-15 шагов с неделями)"
    }}
  ]
}}

ВАЖНО:
- Используй РЕАЛЬНЫЕ боли из данных выше
- НЕ придумывай новые боли - работай только с тем что найдено
- В brief_evidence используй реальные цитаты (evidence_quotes)
- Confidence level бери из реальных данных
- Если боль имеет confidence_level = "high", это приоритетная идея
- Каждая идея должна иметь минимум 2 аналога (реальные продукты с URL)
- Планы должны быть реалистичными для small team/solo-founder

Отвечай только валидным JSON без комментариев."""


def get_generate_ideas_prompt(direction: str = "") -> tuple[str, str]:
    """
    Get the main ideas generation prompt with random direction selection

    Returns:
        tuple: (prompt, selected_direction)
    """
    if not direction or direction.strip() == "":
        # Случайно выбираем 2-3 направления для более разнообразных идей
        num_directions = random.randint(2, 3)
        selected_directions = random.sample(BUSINESS_DIRECTIONS, num_directions)
        direction = ", ".join(selected_directions)

    return QUICK_IDEAS_PROMPT.format(direction=direction), direction


def get_generate_ideas_from_real_pains_prompt(direction: str, real_pains: list) -> str:
    """
    Get prompt for generating ideas from real user pains found via Tavily

    Args:
        direction: Business direction
        real_pains: List of structured pain data from PainAnalyzer

    Returns:
        Formatted prompt string
    """
    # Format real pains into readable text
    pains_text = ""
    for idx, pain in enumerate(real_pains, 1):
        pain_desc = pain.get('pain_description', '')
        segment = pain.get('segment', '')
        confidence = pain.get('confidence_level', 'medium')
        quotes = pain.get('evidence_quotes', [])

        pains_text += f"""
--- Боль #{idx} (Confidence: {confidence}) ---
Описание: {pain_desc}
Сегмент: {segment}
Доказательства (цитаты из реальных обсуждений):
"""
        for quote in quotes[:3]:  # Max 3 quotes per pain
            pains_text += f"  - \"{quote}\"\n"

        pains_text += "\n"

    return GENERATE_IDEAS_FROM_REAL_PAINS_PROMPT.format(
        direction=direction,
        real_pains=pains_text
    )
